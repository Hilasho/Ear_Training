<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>üéµ Interval Singing Trainer</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --sunflower: #FFCC00;
  --hot-pink: #FF0066;
  --electric-blue: #4361EE;
  --mint-green: #00F5D4;
  --punk-black: #1A1A1D;
  --off-white: #FDFDFF;
  
  --border-thick: 4px solid var(--punk-black);
  --shadow-hard: 6px 6px 0px var(--punk-black);
  --shadow-hover: 2px 2px 0px var(--punk-black);
  --radius-cute: 16px;
  --radius-pill: 50px;
}

* { 
  box-sizing: border-box; 
  font-family: 'Outfit', system-ui, sans-serif;
}

body {
  margin: 0;
  background-color: var(--off-white);
  background-image: 
    linear-gradient(45deg, #e5e5f0 25%, transparent 25%, transparent 75%, #e5e5f0 75%, #e5e5f0),
    linear-gradient(45deg, #e5e5f0 25%, transparent 25%, transparent 75%, #e5e5f0 75%, #e5e5f0);
  background-size: 40px 40px;
  background-position: 0 0, 20px 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
  color: var(--punk-black);
}

.card {
  width: 100%;
  max-width: 500px;
  background: var(--sunflower);
  border: var(--border-thick);
  border-radius: 24px;
  padding: 32px 24px;
  box-shadow: 12px 12px 0px var(--punk-black);
  display: flex;
  flex-direction: column;
  gap: 24px;
  position: relative;
  overflow: hidden;
}

.card::before {
  content: 'üåª VOCALS ‚ö°Ô∏è';
  position: absolute;
  top: 16px;
  right: -35px;
  background: var(--hot-pink);
  color: var(--off-white);
  padding: 4px 40px;
  transform: rotate(15deg);
  font-weight: 900;
  font-size: 0.85rem;
  letter-spacing: 1px;
  border: 2px solid var(--punk-black);
  box-shadow: 2px 2px 0 var(--punk-black);
  z-index: 10;
}

/* Nav & Back Button */
.top-nav {
  display: flex;
  justify-content: flex-start;
  margin-bottom: -12px; /* Pulls header up closer */
  z-index: 1;
}

.btn-back {
  background: var(--off-white);
  color: var(--punk-black);
  border: 3px solid var(--punk-black);
  border-radius: 10px;
  padding: 6px 14px;
  font-weight: 900;
  text-decoration: none;
  text-transform: uppercase;
  font-size: 0.85rem;
  box-shadow: 3px 3px 0px var(--punk-black);
  transition: transform 0.1s, box-shadow 0.1s;
}

.btn-back:active {
  transform: translate(2px, 2px);
  box-shadow: 1px 1px 0px var(--punk-black);
}

h1 {
  margin: 0;
  font-size: 2.2rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: -1px;
  line-height: 1.1;
  text-shadow: 3px 3px 0px var(--off-white);
}

/* Stats Grid */
.stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  font-size: 0.95rem;
  font-weight: 800;
}

.stat-badge {
  background: var(--off-white);
  border: 2px solid var(--punk-black);
  border-radius: var(--radius-cute);
  padding: 10px;
  text-align: center;
  box-shadow: 3px 3px 0px var(--punk-black);
}

.stat-badge strong {
  font-size: 1.2rem;
  display: block;
  color: var(--hot-pink);
}

.progress {
  height: 20px;
  background: var(--off-white);
  border: 2px solid var(--punk-black);
  border-radius: var(--radius-pill);
  overflow: hidden;
  box-shadow: inset 3px 3px 0px rgba(0,0,0,0.1);
}

.progress-bar {
  height: 100%;
  width: 0%;
  background: var(--mint-green);
  border-right: 2px solid var(--punk-black);
  transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.btn-reset {
  background: transparent;
  border: 2px dashed var(--punk-black);
  border-radius: var(--radius-pill);
  padding: 8px 16px;
  font-size: 0.85rem;
  font-weight: 800;
  cursor: pointer;
  align-self: center;
  transition: all 0.2s;
  color: var(--punk-black);
}
.btn-reset:hover {
  background: var(--punk-black);
  color: var(--sunflower);
}

/* The Exercise Screen */
.exercise {
  text-align: center;
  font-size: 1.2rem;
  padding: 24px;
  background: var(--punk-black);
  color: var(--off-white);
  border-radius: var(--radius-cute);
  min-height: 100px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 8px;
  transform: rotate(-1deg);
  box-shadow: 6px 6px 0px var(--electric-blue);
  border: 2px solid var(--punk-black);
}

.exercise strong {
  color: var(--sunflower);
  font-size: 1.8rem;
  font-weight: 900;
  letter-spacing: 1px;
}

/* Buttons */
.controls, .actions {
  display: flex;
  gap: 12px;
  justify-content: center;
}

button.tactile {
  flex: 1;
  border: var(--border-thick);
  border-radius: var(--radius-cute);
  padding: 14px 20px;
  font-size: 1rem;
  font-weight: 900;
  text-transform: uppercase;
  cursor: pointer;
  box-shadow: var(--shadow-hard);
  transition: transform 0.1s, box-shadow 0.1s;
}

button.tactile:active {
  transform: translate(4px, 4px);
  box-shadow: var(--shadow-hover);
}

button.tactile:disabled { 
  opacity: 0.5; 
  cursor: not-allowed; 
  transform: none;
  box-shadow: var(--shadow-hard);
}

.primary { background: var(--off-white); color: var(--punk-black); }
.secondary { background: var(--electric-blue); color: var(--off-white); }
.success { background: var(--mint-green); color: var(--punk-black); }
.danger { background: var(--hot-pink); color: var(--off-white); }

/* Settings */
.settings-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  font-weight: 800;
  font-size: 1.1rem;
  background: var(--off-white);
  padding: 12px;
  border: 2px solid var(--punk-black);
  border-radius: var(--radius-cute);
  box-shadow: 3px 3px 0px var(--punk-black);
}

select {
  padding: 6px 12px;
  border: 2px solid var(--punk-black);
  border-radius: 8px;
  font-weight: 800;
  font-size: 1rem;
  background: var(--sunflower);
  cursor: pointer;
  outline: none;
}

/* Feedback Animation */
.feedback {
  text-align: center;
  font-weight: 900;
  min-height: 30px;
  font-size: 1.4rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.2s ease;
}

.feedback.show {
  opacity: 1;
  transform: translateY(0);
}

.feedback.correct { color: var(--punk-black); text-shadow: 2px 2px 0px var(--mint-green); }
.feedback.wrong { color: var(--punk-black); text-shadow: 2px 2px 0px var(--hot-pink); }

@media(max-width:480px){
  .card { padding: 24px 16px; border-width: 3px; box-shadow: 8px 8px 0px var(--punk-black); }
  h1 { font-size: 1.8rem; }
  .controls, .actions { flex-direction: column; }
  button.tactile { width: 100%; }
}
</style>
</head>
<body>

<div class="card">
  <div class="top-nav">
    <a href="index.html" class="btn-back">‚¨Ö Back</a>
  </div>

  <h1>Interval<br>Trainer</h1>

  <div class="stats">
    <div class="stat-badge">‚úî Correct <strong id="correct">0</strong></div>
    <div class="stat-badge">‚úò Wrong <strong id="wrong">0</strong></div>
    <div class="stat-badge">Attempts <strong id="attempts">0</strong></div>
    <div class="stat-badge">Success <strong id="rate">0</strong>%</div>
  </div>

  <div class="progress">
    <div id="progressBar" class="progress-bar"></div>
  </div>

  <button class="btn-reset" onclick="resetStats()">‚Ü∫ Reset Stats</button>

  <div class="exercise" id="exercise">Ready to sing? üé§<br> Hit New Exercise!</div>

  <div class="controls">
    <button class="tactile primary" onclick="generateExercise()">New üéµ</button>
    <button class="tactile secondary" onclick="tellMe()">Tell Me üéπ</button>
  </div>

  <div class="actions">
    <button class="tactile success" onclick="markCorrect()">Nailed It ‚úî</button>
    <button class="tactile danger" onclick="markWrong()">Missed ‚úò</button>
  </div>

  <div class="settings-row">
    <label for="octave">Octave:</label>
    <select id="octave">
      <option value="3">3</option>
      <option value="4" selected>4</option>
      <option value="5">5</option>
    </select>
  </div>

  <div id="feedback" class="feedback"></div>
</div>

<script>
const NOTES = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
const INTERVALS = [
  { name: "Minor 2nd", semitones: 1 },
  { name: "Major 2nd", semitones: 2 },
  { name: "Minor 3rd", semitones: 3 },
  { name: "Major 3rd", semitones: 4 },
  { name: "Perfect 4th", semitones: 5 },
  { name: "Tritone", semitones: 6 },
  { name: "Perfect 5th", semitones: 7 },
  { name: "Minor 6th", semitones: 8 },
  { name: "Major 6th", semitones: 9 },
  { name: "Minor 7th", semitones: 10 },
  { name: "Major 7th", semitones: 11 },
  { name: "Octave", semitones: 12 }
];

let audioCtx;
let currentNoteIndex=null;
let currentInterval=null;
let direction=null;
let correct=0;
let wrong=0;

function ensureAudio(){ if(!audioCtx) audioCtx=new(AudioContext||webkitAudioContext)(); }

function playPianoTone(freq,duration=1.5){
  ensureAudio();
  const now=audioCtx.currentTime;
  [1,2,3,4].forEach((h,i)=>{
    const osc=audioCtx.createOscillator();
    const gainNode=audioCtx.createGain();
    osc.type="sine";
    osc.frequency.value=freq*h;
    osc.connect(gainNode);
    gainNode.connect(audioCtx.destination);
    gainNode.gain.setValueAtTime(0.4/(i+1),now);
    gainNode.gain.exponentialRampToValueAtTime(0.0001,now+duration);
    osc.start(now);
    osc.stop(now+duration);
  });
}

function noteToFrequency(noteIndex,octave){
  const a4Index=9;
  const semitoneDistance=noteIndex-a4Index+(octave-4)*12;
  return 440*Math.pow(2,semitoneDistance/12);
}

function generateExercise(){
  currentNoteIndex=Math.floor(Math.random()*NOTES.length);
  currentInterval=INTERVALS[Math.floor(Math.random()*INTERVALS.length)];
  direction=Math.random()>0.5?"above":"below";
  const octave=parseInt(document.getElementById("octave").value);
  const freq=noteToFrequency(currentNoteIndex,octave);
  
  const dirIcon = direction === "above" ? "‚¨ÜÔ∏è up" : "‚¨áÔ∏è down";

  document.getElementById("exercise").innerHTML=
    `Start on: <br><strong>${NOTES[currentNoteIndex]}${octave}</strong><br>
     Sing a <strong>${currentInterval.name}</strong> ${dirIcon}`;

  const fb = document.getElementById("feedback");
  fb.className = "feedback";
  fb.textContent = "";

  playPianoTone(freq);
}

function tellMe(){
  if(currentNoteIndex===null) return;
  const octave=parseInt(document.getElementById("octave").value);
  const baseFreq=noteToFrequency(currentNoteIndex,octave);
  const semitoneChange=direction==="above"?currentInterval.semitones:-currentInterval.semitones;
  const targetFreq=baseFreq*Math.pow(2,semitoneChange/12);
  playPianoTone(baseFreq);
  setTimeout(()=>playPianoTone(targetFreq),1200);
}

function updateStats(){
  const attempts=correct+wrong;
  document.getElementById("correct").innerText=correct;
  document.getElementById("wrong").innerText=wrong;
  document.getElementById("attempts").innerText=attempts;
  const rate=attempts?Math.round((correct/attempts)*100):0;
  document.getElementById("rate").innerText=rate;
  document.getElementById("progressBar").style.width=rate+"%";
}

function playSuccess(){ playPianoTone(880,0.4); setTimeout(()=>playPianoTone(1100,0.4),200); }
function playFail(){ playPianoTone(220,0.6); }

function showFeedback(text, type) {
  const fb = document.getElementById("feedback");
  fb.textContent = text;
  fb.className = `feedback show ${type}`;
}

function markCorrect(){ 
  if(currentNoteIndex === null) return;
  correct++; 
  updateStats(); 
  showFeedback("üî• PERFECT!", "correct"); 
  playSuccess(); 
  setTimeout(generateExercise, 1000); 
}

function markWrong(){ 
  if(currentNoteIndex === null) return;
  wrong++; 
  updateStats(); 
  showFeedback("üíÄ OOF, MISSED", "wrong"); 
  playFail(); 
  setTimeout(generateExercise, 1000); 
}

function resetStats(){ 
  correct=0; 
  wrong=0; 
  updateStats(); 
  const fb = document.getElementById("feedback");
  fb.className = "feedback";
  fb.textContent = ""; 
}
</script>

</body>
</html>
